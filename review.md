# PHP App ① レビュー

## 全般

### 以下のaタグのリンクを押下した際にedit.phpの$_GETにどんな値が格納されるか説明してください。

```html
<a href="edit.php?todo_id=123&todo_content=焼肉">更新</a>
```
- $todo_id　= $_GET['todo_id'];には123の値が
$todo_content　= $_GET['todo_content'];には焼肉の値が格納されている。
具体的には更新のリンクを押すとブラウザはedit.phpのページに移動する。この際に?以降の部分todo_id=123&todo_content=焼肉がサーバーに送信される
edit.phpで$_GETを使うとtodo_idとtodo_contentの2つの値にアクセスすることができる。ページ内でこれらの値を取得して処理することができる。


### 以下のフォームの送信ボタンを押下した際にstore.phpの$_POSTにどんな値が格納されるか説明してください。

```html
<form action="store.php" method="post">
    <input type="text" name="id" value="123">
		<textarea　name="content">焼肉</textarea>
    <button type="submit">送信</button>
</form>
```
- 送信した際にそのデータは$_POSTという変数に格納される
<input type="text" name="id" value="123">のname=idの部分がキーになる
value="123"の値がキーに対応する値となる
送信されるデータには$_POST['id'] = '123';となる
<textarea　name="content">焼肉</textarea>のname=contentの部分がキーになる
textareaの内容（焼肉）が値となる
送信されるデータには$_POST['content'] = '焼肉';となる
$_Post = array(
  'id' => '123',
  'content' => '焼肉'
);
送信後stroe.phpで受取るデータは上記のようになる。

### `require_once()` は何のために記述しているか説明してください。
- ()に記載した作成中のファイルを読み込み使用することができる。これによりファイルの重複読み込み防止対策になる。

### `savePostedData($post)`は何をしているか説明してください。
- savePostedData($post)関数はＷｅｂフォームに入力したデータをデータベースに保存する関数。
（$Post）引数内にはフォームから送信されたデータが入っている。
データを保存するためにはデータベースに接続する。
このデータはconnection.phpで設定されている接続情報を利用する。
データベースに保存が成功するとデータが正常に保存されたと表示され、保存ができなかった場合にはエラーメッセージの表示がされる。
データの内容に応じて異なる処理を行うことができる。データの内容を変えて利特別な処理を追加することができる。同じデータ保存の関数が様々なシチュエーションで対応できるようになる。

### `header('location: ./index.php')`は何をしているか説明してください。
- header関数を用いて、index.htmlというlocationを指定して移動する処理を実施している。
header関数でヘッダーを書き換えることでブラウザでアクセスした人に特定のページの情報を送ることができる。
header()関数を使用してLocationヘッダーを設定しヘッダーに指定されたURL(./index.php)にブラウザがリダイレクト（別ページに移動すること）できる。
終了時には必ずexit();を付け加える

### `getRefererPath()`は何をしているか説明してください。
- getRefererPath()関数はユーザーが現在のページに来る前にどのページにいたのか、どこから現在のページにきたのかを知るための関数。
具体的にはユーザーが現在のページにアクセスする前にいたページのＵＲＬを取得する。これをRefererという。
その後Referer情報が提供されているかの確認、Referer URLからページのPathの部分を取り出す。
PathとはURLのドメインの後に続く部分。
そのPathを返しこれによりユーザーがどのページから来たのかを知ることができる。

### `connectPdo()` の返り値は何か、またこの記述は何をするための記述か説明してください。
- データベースに接続しその接続オブジェクトを返すために使用
connectPDOオブジェクト（）関数が成功したときPDOインスタンスが返される。
PDOオブジェクトはデータベースへのクエリの実行やトランザクション（一連の操作を一つの単位として扱う処理）の管理など、データベースの操作を行うために必要。
失敗時にはエラーメッセージが表示されＮＵＬＬを返す
もしくは設定されたエラーメッセージが返される。

### `try catch`とは何か説明してください。
- 例外処理を実施する場合に使用する
名前を指定してファイルを開く処理
DBの値を操作する処理
渡された引数を使って割り算処理を行う場合
try{}内に例外が発生する可能性のあるコードを記述する
例外が発生した場合にはcatch{}で記載したエラーメッセージが表示されるようになる。

### Pdoクラスをインスタンス化する際に`try catch`が必要な理由を説明してください。
- PDOのインスタンス化（new PDO()中にエラーが発生する可能性がある。エラーはPDOによってPDOexceptionとしてthrowされるためcatchの部分で捉えることができる。
例外が発生してもプログラムの停止を防ぐことができる。
適切なエラーメッセージを表示し、ユーザーに対して問題の原因を理解し適切な対応をとることができる。

## 新規作成

### `createTodoData($post)`は何をしているか説明してください。
- createTodoData($post)関数は新しいタスクデータをデータベースに追加するための一連の操作を行う関数。
$postに含まれるデータが正しいか、必要な情報が含まれているかを確認する。
データを保存する前にデータの整理を行う、日付の形式を統一などの確認を行う。
connection.phpなどを利用してデータベースへ接続し保存する。
データの保存が完了した場合、完了のメッセージを表示したり、他ページにリダイレクトする処理を行う。
ユーザーが入力したタスク情報を確認、整理してからデータベースに安全に保存するための処理を行っている。

## 一覧

### `getTodoList()`の返り値について説明してください。
- getTodoList()の返り値はデータベースに保存されているTodo（タスク）リストのこと。
この関数ではデータベースから全てのタスクを取得し、それを処理、表示するためのデータとして返してくれる関数
返り値の形式としては配列が使用されることが多い

### `<?= ?>`は何の省略形か説明してください。
- phpのショートオープンタグの一つ<?php echo?>の省略型
<?=?>の中に記載された内容がブラウザに表示される、コードを簡潔に書ける。HTMLと混在してPHPの処理を書く際に処理の開始と終了がわかりいやすいのでこの記載方法がよい。

## 更新  

### `getSelectedTodo($_GET['id'])`の返り値は何か、またなぜ`$_GET['id']` を引数に渡すのか説明してください。
- getSelectedTodo($_GET['id']) 関数は、指定された id に対応する特定のTodoデータを取得するためのものです。返り値は id に関連するTodoの情報を含む連想配列もしくはオブジェクトが返されます。
$_GET['id'] を引数に渡している理由は、ユーザーがWebページにアクセスした際にURLから送信されるクエリパラメータ id を使って、Todoデータを取得するかを指定するためです。例えば、URLに id=1 が含まれていれば、$_GET['id'] には 1 という値が入り、その id に対応するTodoデータを取得するために getSelectedTodo 関数を呼び出します。

### `updateTodoData($post)`は何をしているか説明してください。
- updateTodoData(＄post)関数はフォームから送信されたデータを受取り、受取ったデータを使いデータベース内のTodoデータを更新します。
ユーザーがTodoの内容を編集して更新ボタンを押すと、その情報が updateTodoData($post)関数に渡されデータベース内のデータが変更される。

## 削除　

### `deleteTodoData($id)`は何をしているか説明してください。
- deleteToData($id)関数は特定のid に対応するTodoデータを削除するもの。
データ自体はデータベースから完全に削除されるわけではなく論理削除という方法を使用する。
データそのものは残っており削除された示すために　deleted_atというフィールドに現在の日時を記録する。
ユーザーがTodoリストから特定のTodoを削除しようとすると、そのTodoのidが
deleteToData関数に渡され、データベース内で該当するレコードが削除された状態となる。

### `deleted_at`を現在時刻で更新すると一覧画面からToDoが非表示になる理由を説明してください。
- 一覧画面は　deleted_at が空（NULL）のTODOだけを表示する
Deleted_atに日時が入るとそのToDoは削除されたと見なされ一覧には表示されなくなる
このフィールドが日時に設定されるとそのToDoは削除されたと見なされる。
deleted_at に現在時刻が設定されると、そのToDoは「削除済み」として扱われ、一覧画面から非表示になります。

### 今回のように実際のデータを削除せずに非表示にすることで削除されたように扱うことを〇〇削除というか。
- 論理削除
### 実際にデータを削除することを〇〇削除というか。
- 物理削除
### 前問のそれぞれの削除のメリット・デメリットについて説明してください。
- 論理削除　deleted_at フィールドに削除日時を記録する。
メリット：
削除したデータの復元が可能、データの変更履歴や削除履歴を管理できる、関連データが削除されても整合性が保たれる
デメリット：
削除済みデータもデータベースに残るデータ量が増加する
検索やクエリのパフォーマンスが低下する可能性がある

- 物理削除　DELETE FROM table WHERE id = ? などのSQL文でデータを削除する。
メリット：
ストレージの節約、パフォーマンスの向上データ量が減るため
デメリット：
復旧が困難、データ削除の履歴管理できない。

